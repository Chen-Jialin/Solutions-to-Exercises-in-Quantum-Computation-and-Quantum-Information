% !Tex program = pdflatex
% Chapter 4 - Quantum circuit
\ifx\allfiles\undefined
\documentclass[en]{sol-man}
\begin{document}
\fi
\chapter{Quantum circuit}

\section{Quantum algorithm}

\section{Single qubit operations}

\begin{exe}
    In Exercise 2.11, which you should do now if you haven't already done it, you compute the eigenvectors of the Pauli matrices. Find the points on the Bloch sphere which corresponding to the normalized eigenvectors of the different Pauli matrices.
\end{exe}
\begin{sol}
    The normalized eigenvectors of $X$ are
    \begin{align}
        \frac{1}{\sqrt{2}}(\lvert 0\rangle+\lvert 1\rangle),\quad\frac{1}{\sqrt{2}}(\lvert 0\rangle-\lvert 1\rangle),
    \end{align}
    which corresponds to the intersection points of the Bloch sphere and the positive $x$ axis, and of the Bloch sphere and the negative $x$ axis.\\
    The normalized eigenvectors of $Y$ are
    \begin{align}
        \frac{1}{\sqrt{2}}(\lvert 0\rangle+i\lvert 1\rangle),\quad\frac{1}{\sqrt{2}}(\lvert 0\rangle-i\lvert 1\rangle),
    \end{align}
    which corresponds to the intersection points of the Bloch sphere and the positive $y$ axis, and of the Bloch sphere and the negative $y$ axis.\\
    The normalized eigenvectors of $Z$ are
    \begin{align}
        \lvert 0\rangle,\quad\lvert 1\rangle,
    \end{align}
    which corresponds to the intersection points of the Bloch sphere and the positive $z$ axis, and of the Bloch sphere and the negative $z$ axis.
\end{sol}

\begin{exe}
    Let $x$ be a real number and $A$ a matrix such that $A^2=I$. Show that
    \begin{align}
        \label{E4.2}
        \exp(iAx)=\cos(x)I+i\sin(x)A.
    \end{align}
    Use this result to verify Equation (4.4) through (4.6)\footnote{Equation 4.4: $R_x(\theta)\equiv e^{-i\theta X/2}=\cos\frac{\theta}{2}I-i\sin\frac{\theta}{2}X=\left[\begin{matrix}
        \cos\frac{\theta}{2}&-i\sin\frac{\theta}{2}\\
        -i\sin\frac{\theta}{2}&\cos\frac{\theta}{2}
    \end{matrix}\right]$;\\
    Equation 4.5: $R_y(\theta)\equiv e^{-i\theta Y/2}=\cos\frac{\theta}{2}I-i\sin\frac{\theta}{2}Y=\left[\begin{matrix}
        \cos\frac{\theta}{2}&-\sin\frac{\theta}{2}\\
        \sin\frac{\theta}{2}&\cos\frac{\theta}{2}
    \end{matrix}\right]$;\\
    Equation 4.6: $R_z(\theta)\equiv e^{-i\theta Z/2}=\cos\frac{\theta}{2}I-i\sin\frac{\theta}{2}Z=\left[\begin{matrix}
        e^{-i\theta/2}&0\\
        0&e^{i\theta/2}
    \end{matrix}\right]$.}.
\end{exe}
\begin{pf}
    Similar to Exercise 2.35 and Problem 2.1, the left side of Equation \eqref{E4.2} is
    \begin{align}
        \exp(iAx)=\sum_{n=0}^{\infty}\frac{1}{n!}(iAx)^n=\sum_{n=1}^{\infty}\frac{(-1)^n}{(2n)!}(Ax)^{2n}+\sum_{n=0}^{\infty}\frac{i(-1)^n}{(2n+1)!}(Ax)^{2n+1}.
    \end{align}
    Note that
    \begin{align}
        A^2=I,
    \end{align}
    so
    \begin{align}
        \exp(iAx)=\sum_{n=0}^{\infty}\frac{(-1)^n}{(2n)!}+\sum_{n=0}^{\infty}\frac{i(-1)^n}{(2n+1)!}Ax^{2n+1}=\cos(x)I+i\sin(x)A,
    \end{align}
    which equals the right side of Equation \eqref{E4.2}.
    Therefore, Equation \eqref{E4.2} holds.

    Using the above result,
    \begin{align}
        \notag R_x(\theta)=&e^{-i\theta X/2}=\cos\left(-\frac{\theta}{2}\right)I+i\sin\left(-\frac{\theta}{2}\right)X=\cos\frac{\theta}{2}I-i\sin\frac{\theta}{2}X=\cos\frac{\theta}{2}\left[\begin{matrix}
            1&0\\
            0&1
        \end{matrix}\right]-i\sin\frac{\theta}{2}\left[\begin{matrix}
            0&1\\
            1&0
        \end{matrix}\right]\\
        =&\left[\begin{matrix}
            \cos\frac{\theta}{2}&-i\sin\frac{\theta}{2}\\
            -i\sin\frac{\theta}{2}&\cos\frac{\theta}{2}
        \end{matrix}\right],
    \end{align}
    which verifies Equation (4.4),
    \begin{align}
        \notag R_Y(\theta)=&e^{-i\theta Y/2}=\cos\left(-\frac{\theta}{2}\right)I+i\sin\left(-\frac{\theta}{2}\right)Y=\cos\frac{\theta}{2}I-i\sin\frac{\theta}{2}Y=\cos\frac{\theta}{2}\left[\begin{matrix}
            1&0\\
            0&1
        \end{matrix}\right]-i\sin\frac{\theta}{2}\left[\begin{matrix}
            0&-i\\
            i&0
        \end{matrix}\right]\\
        =&\left[\begin{matrix}
            \cos\frac{\theta}{2}&-\sin\frac{\theta}{2}\\
            \sin\frac{\theta}{2}&\cos\frac{\theta}{2}
        \end{matrix}\right],
    \end{align}
    which verifies Equation (4.5), and
    \begin{align}
        \notag R_Z(\theta)=&e^{-i\theta Z/2}=\cos\left(-\frac{\theta}{2}\right)I+i\sin\left(-\frac{\theta}{2}\right)Z=\cos\frac{\theta}{2}I-i\sin\frac{\theta}{2}Z=\cos\frac{\theta}{2}\left[\begin{matrix}
            1&0\\
            0&1
        \end{matrix}\right]-i\sin\frac{\theta}{2}\left[\begin{matrix}
            1&0\\
            0&-1
        \end{matrix}\right]\\
        =&\left[\begin{matrix}
            \cos\frac{\theta}{2}-i\sin\frac{\theta}{2}&0\\
            0&\cos\frac{\theta}{2}+i\sin\frac{\theta}{2}
        \end{matrix}\right]=\left[\begin{matrix}
            e^{-i\theta/2}&0\\
            0&e^{i\theta/2}
        \end{matrix}\right],
    \end{align}
    which verifies Equation (4.6).
\end{pf}

\begin{exe}
    Show that, up to a global phase, the $\pi/8$ gate satisfies $T=R_z(\pi/4)$.
\end{exe}
\begin{pf}
    Using the conclusion proved in the previous exercise,
    \begin{align}
        R_z(\pi/4)=\left[\begin{matrix}
            e^{-i\pi/8}&0\\
            0&e^{i\pi/8}
        \end{matrix}\right]=\exp(-i\pi/8)T,
    \end{align}
    so the $\pi/8$ gate satisfies $T=R_z(\pi/4)$ up to a global phase.
\end{pf}

\begin{exe}
    Express the Hadamard gate $H$ as a product of $R_x$ and $R_z$ rotations and $e^{i\varphi}$ for some $\varphi$.
\end{exe}
\begin{pf}
    Since
    \begin{align}
        \notag e^{i\pi/2}R_z\left(\frac{\pi}{2}\right)R_x\left(\frac{\pi}{2}\right)R_z\left(\frac{\pi}{2}\right)=&e^{i\pi/2}\left[\begin{matrix}
            e^{-i\pi/4}&0\\
            0&e^{i\pi/4}
        \end{matrix}\right]\left[\begin{matrix}
            \cos\frac{\pi}{4}&-i\sin\frac{\pi}{4}\\
            -i\sin\frac{\pi}{4}&\cos\frac{\pi}{4}
        \end{matrix}\right]\left[\begin{matrix}
            e^{-i\pi/4}&0\\
            0&e^{i\pi/4}
        \end{matrix}\right]\\
        \notag=&e^{i\pi/2}\left[\begin{matrix}
            e^{-i\pi/4}\cos\frac{\pi}{4}&-ie^{-i\pi/4}\sin\frac{\pi}{4}\\
            -ie^{i\pi/4}\sin\frac{\pi}{4}&e^{i\pi/4}\cos\frac{\pi}{4}
        \end{matrix}\right]\left[\begin{matrix}
            e^{-i\pi/4}&0\\
            0&e^{i\pi/4}
        \end{matrix}\right]\\
        \notag=&e^{i\pi/2}\left[\begin{matrix}
            e^{-i\pi/2}\cos\frac{\pi}{4}&-i\sin\frac{\pi}{4}\\
            -i\sin\frac{\pi}{4}&e^{i\pi/2}\cos\frac{\pi}{4}
        \end{matrix}\right]=\frac{1}{\sqrt{2}}\left[\begin{matrix}
            1&1\\
            1&-1
        \end{matrix}\right]=H,
    \end{align}
    the Hadamard gate $H$ can be expressed as a product of $R_x$ and $R_z$ rotations and $e^{i\varphi}$.
\end{pf}

\begin{exe}
    Prove that $(\hat{n}\cdot\vec{\sigma})^2=I$, and use this to verify Equation (4.8)\footnote{$R_{\hat{n}}(\theta)\equiv\exp(-i\theta\hat{n}\cdot\vec{\sigma}/2)=\cos\left(\frac{\theta}{2}\right)I-i\sin\left(\frac{\theta}{2}\right)(n_xX+n_yY+n_zZ)$.}.
\end{exe}
\begin{pf}
    Similar to Exercise 2.35,
    \begin{gather}
        \hat{n}\cdot\vec{\sigma}=n_x\sigma_1+n_y\sigma_2+n_z\sigma_3=n_x\left[\begin{matrix}
            0&1\\
            1&0
        \end{matrix}\right]+n_y\left[\begin{matrix}
            0&-i\\
            i&0
        \end{matrix}\right]+n_z\left[\begin{matrix}
            1&0\\
            0&-1
        \end{matrix}\right]=\left[\begin{matrix}
            n_z&n_x-in_y\\
            n_x+in_y&-n_z
        \end{matrix}\right],\\
        \Longrightarrow(\hat{n}\cdot\vec{\sigma})^2=\left[\begin{matrix}
            n_z&n_x-in_y\\
            n_x+in_y&-n_z
        \end{matrix}\right]\left[\begin{matrix}
            n_z&n_x-in_y\\
            n_x+in_y&-n_z
        \end{matrix}\right]=\left[\begin{matrix}
            n_x^2+n_y^2+n_z^2&0\\
            0&n_x^2+n_y^2+n_z^2
        \end{matrix}\right]=\left[\begin{matrix}
            1&0\\
            0&1
        \end{matrix}\right]=I.
    \end{gather}

    Using the above result,
    \begin{align}
        \notag R_{\hat{n}}(\theta)=&\exp(-i\theta\hat{n}\cdot\vec{\sigma}/2)=\sum_{k=0}^{\infty}\frac{1}{k!}(-i\theta\hat{n}\cdot\vec{\sigma}/2)=\sum_{k=0}^{\infty}\frac{1}{(2k)!}(-i\theta\hat{n}\cdot\vec{\sigma}/2)^{2k}+\sum_{k=0}^{\infty}\frac{1}{(2k+1)!}(-i\theta\hat{n}\cdot\vec{\sigma}/2)^{2k+1}\\
        \notag=&\sum_{k=0}^{\infty}\frac{(-1)^k}{(2k)!}\left(\frac{\theta}{2}\right)^{2k}+\sum_{k=0}^{\infty}\frac{-i(-1)^k}{(2k+1)!}\left(\frac{\theta}{2}\right)^{2k+1}(\hat{n}\cdot\vec{\sigma})=\cos\left(\frac{\theta}{2}\right)I-i\sin\left(\frac{\theta}{2}\right)(\hat{n}\cdot\vec{\sigma})\\
        =&\cos\left(\frac{\theta}{2}\right)I-i\sin\left(\frac{\theta}{2}\right)(n_xX+n_yY+n_zZ),
    \end{align}
    which verifies Equation (4.8).
\end{pf}

\begin{exe}[Bloch sphere interpretation of rotations]
    One reason why the $R_{\hat{n}}(\theta)$ operators are referred to as rotation operators is the following fact, which you are to prove. Suppose a single qubit has a state represented by Bloch vector $\vec{\lambda}$. Then the effect of the rotation $R_{\hat{n}}(\theta)$ on the state is to rotate it by an angle $\theta$ about the $\hat{n}$ axis of the Bloch sphere. This fact explains the rather mysterious looking factor of two in the definition of the rotation matrices.
\end{exe}
\begin{pf}
    \footnote{\url{http://www.vcpc.univie.ac.at/~ian/hotlist/qc/talks/bloch-sphere-rotations.pdf}}Suppose $\hat{n}$ forms angle $\theta$ with the $z$ axis and the projection of $\hat{n}$ onto the $xy$ plane forms angle $\varphi$ with the $x$ axis, i.e.
    \begin{align}
        \label{E4.8}
        \hat{n}=n_x\hat{x}+n_y\hat{y}+n_z\hat{z}=\sin\theta\cos\varphi\hat{x}+\sin\theta\sin\varphi\hat{y}+\cos\theta\hat{z}.
    \end{align}
    Rotating the Bloch vector $\vec{\lambda}$ about $\hat{n}$ axis by angle $\alpha$ is equivalent to the following operation sequence:
    \begin{itemize}
        \item[1.] Rotating about $z$ axis by angle $-\varphi$ so that $\hat{n}$ is rotated onto $xz$ plane;
        \item[2.] Rotating about $y$ axis by angle $-\theta$ so that $\hat{n}$ coincides with $z$ axis;
        \item[3.] Rotating about $z$ axis by angle $\alpha$ so $\vec{\lambda}$ is rotated about $\hat{n}$ axis by angle $\alpha$;
        \item[4.] Rotating about $y$ axis by angle $\theta$ to counteract operation step 2.;
        \item[5.] Rotating about $z$ axis by angle $\theta$ to counteract operation step 1. so that $\hat{n}$ is rotated back to its original position,
    \end{itemize}
    i.e.,
    \begin{align}
        \notag&R_z(\varphi)R_y(\theta)R_z(\alpha)R_y(-\theta)R_z(-\varphi)\\
        \notag=&\left[\cos\frac{\varphi}{2}I-i\sin\frac{\varphi}{2}Z\right]\left[\cos\frac{\theta}{2}I-i\sin\frac{\theta}{2}Y\right]\left[\cos\frac{\alpha}{2}I-i\sin\frac{\alpha}{2}Z\right]\left[\cos\frac{\theta}{2}I+i\sin\frac{\theta}{2}Y\right]\left[\cos\frac{\varphi}{2}I+i\sin\frac{\varphi}{2}Z\right]\\
        \notag=&\left[\cos\frac{\varphi}{2}I-i\sin\frac{\varphi}{2}Z\right]\left[\cos\frac{\theta}{2}\cos\frac{\alpha}{2}I-i\cos\frac{\theta}{2}\sin\frac{\alpha}{2}Z-i\sin\frac{\theta}{2}\cos\frac{\alpha}{2}Y-\sin\frac{\theta}{2}\sin\frac{\alpha}{2}YZ\right]\left[\cos\frac{\theta}{2}I+i\sin\frac{\theta}{2}Y\right]\\
        \notag&\left[\cos\frac{\varphi}{2}I+i\sin\frac{\varphi}{2}Z\right]\\
        \notag=&\left[\cos\frac{\varphi}{2}I-i\sin\frac{\varphi}{2}Z\right]\left[\cos\frac{\theta}{2}\cos\frac{\alpha}{2}I-i\cos\frac{\theta}{2}\sin\frac{\alpha}{2}Z-i\sin\frac{\theta}{2}\cos\frac{\alpha}{2}Y-i\sin\frac{\theta}{2}\sin\frac{\alpha}{2}X\right]\left[\cos\frac{\theta}{2}I+i\sin\frac{\theta}{2}Y\right]\\
        \notag&\left[\cos\frac{\varphi}{2}I+i\sin\frac{\varphi}{2}Z\right]\\
        \notag=&\left[\cos\frac{\varphi}{2}I-i\sin\frac{\varphi}{2}Z\right]\left[\cos^2\frac{\theta}{2}\cos\frac{\alpha}{2}I-i\cos^2\frac{\theta}{2}\sin\frac{\alpha}{2}Z-i\sin\frac{\theta}{2}\cos\frac{\theta}{2}\cos\frac{\alpha}{2}Y-i\sin\frac{\theta}{2}\cos\frac{\theta}{2}\sin\frac{\alpha}{2}X\right.\\
        &\left.+i\cos\frac{\theta}{2}\sin\frac{\theta}{2}\cos\frac{\alpha}{2}Y+\cos\frac{\theta}{2}\sin\frac{\theta}{2}\sin\frac{\alpha}{2}ZY+\sin^2\frac{\theta}{2}\cos\frac{\alpha}{2}Y^2+\sin^2\frac{\theta}{2}\sin\frac{\alpha}{2}XY\right]\left[\cos\frac{\varphi}{2}I+i\sin\frac{\varphi}{2}Z\right]\\
        \notag=&\left[\cos\frac{\varphi}{2}I-i\sin\frac{\varphi}{2}Z\right]\left[\cos^2\frac{\theta}{2}\cos\frac{\alpha}{2}I-i\cos^2\frac{\theta}{2}\sin\frac{\alpha}{2}Z-i\sin\frac{\theta}{2}\cos\frac{\theta}{2}\cos\frac{\alpha}{2}Y-i\sin\frac{\theta}{2}\cos\frac{\theta}{2}\sin\frac{\alpha}{2}X\right.\\
        \notag&\left.+i\cos\frac{\theta}{2}\sin\frac{\theta}{2}\cos\frac{\alpha}{2}Y-i\cos\frac{\theta}{2}\sin\frac{\theta}{2}\sin\frac{\alpha}{2}X+\sin^2\frac{\theta}{2}\cos\frac{\alpha}{2}I+i\sin^2\frac{\theta}{2}\sin\frac{\alpha}{2}Z\right]\left[\cos\frac{\varphi}{2}I+i\sin\frac{\varphi}{2}Z\right]\\
        \notag=&\left[\cos\frac{\varphi}{2}I-i\sin\frac{\varphi}{2}Z\right]\left[\cos\frac{\alpha}{2}I-i\cos\theta\sin\frac{\alpha}{2}Z-i\sin\theta\sin\frac{\alpha}{2}X\right]\left[\cos\frac{\varphi}{2}I+i\sin\frac{\varphi}{2}Z\right]\\
        \notag=&\left[\cos\frac{\varphi}{2}\cos\frac{\alpha}{2}I-i\cos\frac{\varphi}{2}\cos\theta\sin\frac{\alpha}{2}Z-i\cos\frac{\varphi}{2}\sin\theta\sin\frac{\alpha}{2}X-i\sin\frac{\varphi}{2}\cos\frac{\alpha}{2}Z-\sin\frac{\varphi}{2}\cos\theta\sin\frac{\alpha}{2}Z^2\right.\\
        \notag&\left.-\sin\frac{\varphi}{2}\sin\theta\sin\frac{\alpha}{2}ZX\right]\left[\cos\frac{\varphi}{2}I+i\sin\frac{\varphi}{2}Z\right]\\
        \notag=&\left[\cos\frac{\varphi}{2}\cos\frac{\alpha}{2}I-i\cos\frac{\varphi}{2}\cos\theta\sin\frac{\alpha}{2}Z-i\cos\frac{\varphi}{2}\sin\theta\sin\frac{\alpha}{2}X-i\sin\frac{\varphi}{2}\cos\frac{\alpha}{2}Z-\sin\frac{\varphi}{2}\cos\theta\sin\frac{\alpha}{2}I-i\sin\frac{\varphi}{2}\sin\theta\sin\frac{\alpha}{2}Y\right]\\
        \notag&\left[\cos\frac{\varphi}{2}I+i\sin\frac{\varphi}{2}Z\right]\\
        \notag=&\left[\left(\cos\frac{\varphi}{2}\cos\frac{\alpha}{2}-\sin\frac{\varphi}{2}\cos\theta\sin\frac{\alpha}{2}\right)I-i\left(\cos\frac{\varphi}{2}\cos\theta\sin\frac{\alpha}{2}+\sin\frac{\varphi}{2}\cos\frac{\alpha}{2}\right)Z-i\cos\frac{\varphi}{2}\sin\theta\sin\frac{\alpha}{2}X\right.\\
        \notag&\left.-i\sin\frac{\varphi}{2}\sin\theta\sin\frac{\alpha}{2}Y\right]\left[\cos\frac{\varphi}{2}I+i\sin\frac{\varphi}{2}Z\right]\\
        \notag=&\cos\frac{\varphi}{2}\left(\cos\frac{\varphi}{2}\cos\frac{\alpha}{2}-\sin\frac{\varphi}{2}\cos\theta\sin\frac{\alpha}{2}\right)I-i\cos\frac{\varphi}{2}\left(\cos\frac{\varphi}{2}\cos\theta\sin\frac{\alpha}{2}+\sin\frac{\varphi}{2}\cos\frac{\alpha}{2}\right)Z-i\cos^2\frac{\varphi}{2}\sin\theta\sin\frac{\alpha}{2}X\\
        \notag&-i\sin\frac{\varphi}{2}\cos\frac{\varphi}{2}\sin\theta\sin\frac{\alpha}{2}Y+i\sin\frac{\varphi}{2}\left(\cos\frac{\varphi}{2}\cos\frac{\alpha}{2}-\sin\frac{\varphi}{2}\cos\theta\sin\frac{\alpha}{2}\right)Z+\sin\frac{\varphi}{2}\left(\cos\frac{\varphi}{2}\cos\theta\sin\frac{\alpha}{2}+\sin\frac{\varphi}{2}\cos\frac{\alpha}{2}\right)Z^2\\
        \notag&+\cos\frac{\varphi}{2}\sin\frac{\varphi}{2}\sin\theta\sin\frac{\alpha}{2}XZ+\sin^2\frac{\varphi}{2}\sin\theta\sin\frac{\alpha}{2}YZ\\
        \notag=&\cos\frac{\varphi}{2}\left(\cos\frac{\varphi}{2}\cos\frac{\alpha}{2}-\sin\frac{\varphi}{2}\cos\theta\sin\frac{\alpha}{2}\right)I-i\cos\frac{\varphi}{2}\left(\cos\frac{\varphi}{2}\cos\theta\sin\frac{\alpha}{2}+\sin\frac{\varphi}{2}\cos\frac{\alpha}{2}\right)Z-i\cos^2\frac{\varphi}{2}\sin\theta\sin\frac{\alpha}{2}X\\
        \notag&-i\sin\frac{\varphi}{2}\cos\frac{\varphi}{2}\sin\theta\sin\frac{\alpha}{2}Y+i\sin\frac{\varphi}{2}\left(\cos\frac{\varphi}{2}\cos\frac{\alpha}{2}-\sin\frac{\varphi}{2}\cos\theta\sin\frac{\alpha}{2}\right)Z+\sin\frac{\varphi}{2}\left(\cos\frac{\varphi}{2}\cos\theta\sin\frac{\alpha}{2}+\sin\frac{\varphi}{2}\cos\frac{\alpha}{2}\right)I\\
        \notag&-i\cos\frac{\varphi}{2}\sin\frac{\varphi}{2}\sin\theta\sin\frac{\alpha}{2}Y+i\sin^2\frac{\varphi}{2}\sin\theta\sin\frac{\alpha}{2}X\\
        =&\cos\frac{\alpha}{2}I-i\sin\frac{\alpha}{2}\left(\cos\varphi\sin\theta X+\sin\varphi\sin\theta Y+\cos\theta Z\right)=\cos\frac{\alpha}{2}I-i(n_xX+n_yY+n_zZ),
    \end{align}
    which equals $R_{\hat{n}}(\alpha)$.
    Therefore, the effect of the rotation $R_{\hat{n}}(\theta)$ on the state is to rotate it by an angle $\theta$ about the $\hat{n}$ axis of the Bloch sphere.
\end{pf}

\begin{exe}
    Show that $XYX=-Y$ and use this to prove that $XR_y(\theta)X=R_y(-\theta)$.
\end{exe}
\begin{pf}
    \begin{align}
        XYX=iZX=i^2Y=-Y.
    \end{align}
    In this way,
    \begin{align}
        \notag XR_y(\theta)X=&X\left(\cos\frac{\theta}{2}I-i\sin\frac{\theta}{2}Y\right)X=\left(\cos\frac{\theta}{2}X-i\sin\frac{\theta}{2}XY\right)X=\left(\cos\frac{\theta}{2}X+\sin\frac{\theta}{2}Z\right)X=\cos\frac{\theta}{2}X^2+\sin\frac{\theta}{2}ZX\\
        =&\cos\frac{\theta}{2}I+i\sin\frac{\theta}{2}Y=R_y(-\theta).
    \end{align}
\end{pf}

\begin{exe}
    An arbitrary single qubit unitary operator can be written in the form
    \begin{align}
        U=\exp(i\alpha)R_{\hat{n}}(\theta)
    \end{align}
    for some real number $\alpha$ and $\theta$, and a real three-dimensional unit vector $\hat{n}$.
    \begin{itemize}
        \item[1.] Prove this fact.
        \item[2.] Find values for $\alpha$, $\theta$, and $\hat{n}$ giving the Hadamard gate $H$.
        \item[3.] Find value for $\alpha$, $\theta$, and $\hat{n}$ giving the phase gate
        \begin{align}
            S=\left[\begin{matrix}
                1&0\\
                0&i
            \end{matrix}\right].
        \end{align}
    \end{itemize}
\end{exe}
\begin{sol}
    \begin{itemize}
        \item[1.] Suppose an arbitrary qubit unitary operator is
        \begin{align}
            U=\left[\begin{matrix}
                a&b\\
                c&d
            \end{matrix}\right].
        \end{align}
        where $a$, $b$, $c$, and $d$ are complex numbers. Since $U$ is unitary,
        \begin{gather}
            UU^{\dagger}=\left[\begin{matrix}
                a&b\\
                c&d
            \end{matrix}\right]\left[\begin{matrix}
                a^*&c^*\\
                b^*&d^*
            \end{matrix}\right]=\left[\begin{matrix}
                aa^*+bb^*&ac^*+bd^*\\
                a^*c+b^*d&cc^*+dd^*
            \end{matrix}\right]=I=\left[\begin{matrix}
                1&0\\
                0&1
            \end{matrix}\right],\\
            \Longrightarrow aa^*+bb^*=cc^*+dd^*=1,\quad ac^*+bd^*=0,\\
            \Longrightarrow c=\mp b^*,\quad d=\pm a^*,\quad\abs{a}^2+\abs{b}^2=1.
        \end{gather}
        Hence $U$ can be written as
        \begin{align}
            U=\left[\begin{matrix}
                a&b\\
                \mp b^*&\pm a^*
            \end{matrix}\right]=\left\{\begin{array}{ll}
                \left[\begin{matrix}
                    a&b\\
                    -b^*&a^*
                \end{matrix}\right],&\text{for }\det(U)=1;\\
                \left[\begin{matrix}
                    a&b\\
                    b^*&-a^*
                \end{matrix}\right],&\text{for }\det(U)=-1,\\
            \end{array}\right.
        \end{align}
        where $\abs{a}^2+\abs{b}^2=1$.
        Without loss of generality, we can find real number $\alpha$, and $\theta$, and a real three-dimensional unit vector $\hat{n}=n_x\hat{x}+n_y\hat{y}+z\hat{z}$ so that
        \begin{align}
            a=&e^{i\alpha}\left(\cos\frac{\theta}{2}-in_z\sin\frac{\theta}{2}\right),\\
            b=&-e^{i\alpha}(in_x+n_y)\sin\frac{\theta}{2},\\
            e^{i\alpha}=&\left\{\begin{array}{ll}
                1,&\text{for }\det(U)=1;\\
                i,&\text{for }\det(U)=-1,\\
            \end{array}\right.
        \end{align}
        which satisfies
        \begin{align}
            \abs{a}^2+\abs{b}^2=\cos^2\frac{\theta}{2}+n_z^2\sin^2\frac{\theta}{2}+n_x^2\sin^2\frac{\theta}{2}+n_y^2\sin^2\frac{\theta}{2}=\cos^2\frac{\theta}{2}+\sin^2\frac{\theta}{2}=1,
        \end{align}
        for $n_x^2+n_y^2+n_z^2=1$.
        In this way, the single qubit unitary operator can be written in the form
        \begin{align}
            \notag U=&\left[\begin{matrix}
                a&b\\
                \mp b^*&\pm a^*
            \end{matrix}\right]=\left[\begin{matrix}
                e^{i\alpha}\left(\cos\frac{\theta}{2}-in_z\sin\frac{\theta}{2}\right)&-e^{i\alpha}(in_x+n_y)\sin\frac{\theta}{2}\\
                \pm e^{-i\alpha}(-in_x+n_y)\sin\frac{\theta}{2}&\pm e^{-i\alpha}\left(\cos\frac{\theta}{2}+in_z\sin\frac{\theta}{2}\right)
            \end{matrix}\right]\\
            \notag=&\left\{\begin{array}{ll}
                \left[\begin{matrix}
                    e^{i\alpha}\left(\cos\frac{\theta}{2}-in_z\sin\frac{\theta}{2}\right)&-e^{i\alpha}(in_x+n_y)\sin\frac{\theta}{2}\\
                    e^{-i\alpha}(-in_x+n_y)\sin\frac{\theta}{2}&e^{-i\alpha}\left(\cos\frac{\theta}{2}+in_z\sin\frac{\theta}{2}\right)
                \end{matrix}\right],&\text{for }\det(U)=1\\
                \left[\begin{matrix}
                    e^{i\alpha}\left(\cos\frac{\theta}{2}-in_z\sin\frac{\theta}{2}\right)&-e^{i\alpha}(in_x+n_y)\sin\frac{\theta}{2}\\
                    -e^{-i\alpha}(-in_x+n_y)\sin\frac{\theta}{2}&-e^{-i\alpha}\left(\cos\frac{\theta}{2}+in_z\sin\frac{\theta}{2}\right)
                \end{matrix}\right],&\text{for }\det(U)=-1
            \end{array}\right.\\
            \notag=&\left\{\begin{array}{ll}
                \left[\begin{matrix}
                    \cos\frac{\theta}{2}-in_z\sin\frac{\theta}{2}&-(in_x+n_y)\sin\frac{\theta}{2}\\
                    (-in_x+n_y)\sin\frac{\theta}{2}&\cos\frac{\theta}{2}+in_z\sin\frac{\theta}{2}
                \end{matrix}\right],&\text{for }\det(U)=1\\
                \left[\begin{matrix}
                    i\left(\cos\frac{\theta}{2}-in_z\sin\frac{\theta}{2}\right)&-i(in_x+n_y)\sin\frac{\theta}{2}\\
                    i(-in_x+n_y)\sin\frac{\theta}{2}&i\left(\cos\frac{\theta}{2}+in_z\sin\frac{\theta}{2}\right)
                \end{matrix}\right],&\text{for }\det(U)=-1
            \end{array}\right.\\
            \notag=&\left\{\begin{array}{ll}
                \left[\begin{matrix}
                    \cos\frac{\theta}{2}-in_z\sin\frac{\theta}{2}&-(in_x+n_y)\sin\frac{\theta}{2}\\
                    (-in_x+n_y)\sin\frac{\theta}{2}&\cos\frac{\theta}{2}+in_z\sin\frac{\theta}{2}
                \end{matrix}\right],&\text{for }\det(U)=1\\
                i\left[\begin{matrix}
                    \cos\frac{\theta}{2}-in_z\sin\frac{\theta}{2}&-(in_x+n_y)\sin\frac{\theta}{2}\\
                    (-in_x+n_y)\sin\frac{\theta}{2}&\cos\frac{\theta}{2}+in_z\sin\frac{\theta}{2}
                \end{matrix}\right],&\text{for }\det(U)=-1
            \end{array}\right.\\
            \notag=&e^{i\alpha}\left[\begin{matrix}
                \cos\frac{\theta}{2}-in_z\sin\frac{\theta}{2}&-(in_x+n_y)\sin\frac{\theta}{2}\\
                (-in_x+n_y)\sin\frac{\theta}{2}&\cos\frac{\theta}{2}+in_z\sin\frac{\theta}{2}
            \end{matrix}\right]\\
            \notag=&e^{i\alpha}\left\{\cos\theta\left[\begin{matrix}
                1&0\\
                0&1
            \end{matrix}\right]-i\sin\theta\left(n_x\left[\begin{matrix}
                0&1\\
                1&0
            \end{matrix}\right]+n_y\left[\begin{matrix}
                0&-i\\
                i&0
            \end{matrix}\right]+n_z\left[\begin{matrix}
                1&0\\
                0&-1
            \end{matrix}\right]\right)\right\}\\
            \notag=&e^{i\alpha}\left[\cos\frac{\theta}{2}I-i\sin\frac{\theta}{2}\left(n_xX+n_yY+n_zZ\right)\right]\\
            =&\exp(i\alpha)R_{\hat{n}}(\theta).
        \end{align}
        \item[2.] The Hadamard gate is
        \begin{align}
            H=\frac{1}{\sqrt{2}}\left[\begin{matrix}
                1&1\\
                1&-1
            \end{matrix}\right],
        \end{align}
        whose determinant is
        \begin{align}
            \det(H)=\abs{\begin{matrix}
                \frac{1}{\sqrt{2}}&\frac{1}{\sqrt{2}}\\
                \frac{1}{\sqrt{2}}&-\frac{1}{\sqrt{2}}
            \end{matrix}}=-1,
        \end{align}
        so we choose
        \begin{gather}
            \begin{align}
                a=&e^{i\alpha}\left(\cos\frac{\theta}{2}-in_z\sin\frac{\theta}{2}\right)=\frac{1}{\sqrt{2}},\\
                b=&-e^{i\alpha}(in_x+n_y)\sin\frac{\theta}{2}=\frac{1}{\sqrt{2}},\\
                e^{i\alpha}=&i,
            \end{align}\\
            \Longrightarrow\alpha=\frac{\pi}{2},\quad\theta=\pi,\quad\hat{n}=n_x\hat{x}+n_y\hat{y}+n_z\hat{z}=\frac{1}{\sqrt{2}}\hat{x}+\frac{1}{\sqrt{2}}\hat{z}.
        \end{gather}
        \item[3.] For phase gate $S$,
        \begin{gather}
            \begin{align}
                e^{i\alpha}\left(\cos\frac{\theta}{2}-in_z\sin\frac{\theta}{2}\right)=&1,\\
                -e^{i\alpha}\left(in_x+n_y\right)\sin\frac{\theta}{2}=0,\\
                e^{-i\alpha}(-in_x+n_y)\sin\frac{\theta}{2}=0,\\
                e^{i\alpha}\left(\cos\frac{\theta}{2}+in_z\sin\frac{\theta}{2}\right)=i,
            \end{align}\\
            \Longrightarrow\alpha=\frac{\pi}{4},\quad\theta=\frac{\pi}{2},\quad\hat{n}=\hat{z}.
        \end{gather}
    \end{itemize}
\end{sol}

\begin{exe}
    Explain why any single qubit unitary operator may be written in the form (4.12)\footnote{$U=\left[\begin{matrix}
        e^{i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2}&-e^{i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2}\\
        e^{i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2}&e^{i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2}
    \end{matrix}\right]$.}.
\end{exe}
\begin{sol}
    Suppose an arbitrary qubit unitary operator is
        \begin{align}
            U=\left[\begin{matrix}
                a&b\\
                c&d
            \end{matrix}\right].
        \end{align}
        where $a$, $b$, $c$, and $d$ are complex numbers. Since $U$ is unitary,
        \begin{gather}
            UU^{\dagger}=\left[\begin{matrix}
                a&b\\
                c&d
            \end{matrix}\right]\left[\begin{matrix}
                a^*&c^*\\
                b^*&d^*
            \end{matrix}\right]=\left[\begin{matrix}
                aa^*+bb^*&ac^*+bd^*\\
                a^*c+b^*d&cc^*+dd^*
            \end{matrix}\right]=I=\left[\begin{matrix}
                1&0\\
                0&1
            \end{matrix}\right],\\
            \Longrightarrow aa^*+bb^*=cc^*+dd^*=1,\quad ac^*+bd^*=0.
        \end{gather}
        Since
        \begin{align}
            \notag&\left[\begin{matrix}
                e^{i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2}&-e^{i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2}\\
                e^{i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2}&e^{i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2}
            \end{matrix}\right]\left[\begin{matrix}
                e^{i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2}&-e^{i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2}\\
                e^{i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2}&e^{i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2}
            \end{matrix}\right]^{\dagger}\\
            \notag=&\left[\begin{matrix}
                e^{i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2}&-e^{i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2}\\
                e^{i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2}&e^{i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2}
            \end{matrix}\right]\left[\begin{matrix}
                e^{-i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2}&e^{-i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2}\\
                -e^{-i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2}&e^{-i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2}
            \end{matrix}\right]\\
            \notag=&\left[\begin{matrix}
                e^{i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2}e^{-i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2}+e^{i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2}e^{-i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2},\\
                e^{i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2}e^{-i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2}-e^{i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2}e^{-i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2};\\
                e^{i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2}e^{-i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2}-e^{i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2}e^{-i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2},\\
                e^{i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2}e^{-i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2}+e^{i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2}e^{-i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2}
            \end{matrix}\right]\\
            =&\left[\begin{matrix}
                1&0\\
                0&1
            \end{matrix}\right],
        \end{align}
        the matrix $\left[\begin{matrix}
            e^{i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2}&-e^{i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2}\\
            e^{i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2}&e^{i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2}
        \end{matrix}\right]$ is also unitary.
        For arbitrary $a$, $b$, $c$, and $d$ such that $U$ is unitary, let
        \begin{align}
            a=&e^{i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2},\\
            b=&-e^{i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2},\\
            c=&e^{i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2},\\
            d=&e^{i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2},
        \end{align}
        i.e., set
        \begin{align}
            \alpha=&-\frac{i}{2}\ln(ad-bc),\\
            \beta=&\frac{i}{2}\ln\left(-\frac{ab}{cd}\right),\\
            \delta=&\frac{i}{2}\ln\left(-\frac{ac}{bd}\right),\\
            \gamma=&\arccos\abs{ad+bc}.
        \end{align}
        Then
        \begin{align}
            U=\left[\begin{matrix}
                e^{i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2}&-e^{i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2}\\
                e^{i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2}&e^{i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2}
            \end{matrix}\right].
        \end{align}
        Therefore, any single unitary operator may be written in the form (4.12).
\end{sol}

\begin{exe}[X-Y decomposition of rotations]
    Give a decomposition analogous to Theorem 4.1\footnote{($Z-Y$ decomposition for single qubit) Suppose $U$ is a unitary operation on a single qubit. Then there exist real numbers $\alpha$, $\beta$, $\gamma$ and $\delta$ such that $U=e^{i\alpha}R_z(\beta)R_y(\gamma)R_z(\delta)$.} but using $R_x$ instead of $R_z$.
\end{exe}
\begin{sol}
    Suppose an arbitrary qubit unitary operator is
    \begin{align}
        U=\left[\begin{matrix}
            a&b\\
            c&d
        \end{matrix}\right],
    \end{align}
    where $a$, $b$, $c$, and $d$ are complex numbers. Since $U$ is unitary,
    \begin{gather}
        UU^{\dagger}=\left[\begin{matrix}
            a&b\\
            c&d
        \end{matrix}\right]\left[\begin{matrix}
            a^*&c^*\\
            b^*&d^*
        \end{matrix}\right]=\left[\begin{matrix}
            aa^*+bb^*&ac^*+bd^*\\
            a^*c+b^*d&cc^*+dd^*
        \end{matrix}\right]=I=\left[\begin{matrix}
            1&0\\
            0&1
        \end{matrix}\right],\\
        \Longrightarrow aa^*+bb^*=cc^*+dd^*=1,\quad ac^*+bd^*=0.
    \end{gather}
    The $X-Y$ decomposition of rotation is
    \begin{align}
        \notag&e^{i\alpha}R_z(\beta)R_x(\gamma)R_z(\delta)=e^{i\alpha}\left[\begin{matrix}
            \cos\frac{\beta}{2}&-i\sin\frac{\beta}{2}\\
            -i\sin\frac{\beta}{2}&\cos\frac{\beta}{2}
        \end{matrix}\right]\left[\begin{matrix}
            \cos\frac{\gamma}{2}&-\sin\frac{\gamma}{2}\\
            \sin\frac{\gamma}{2}&\cos\frac{\gamma}{2}
        \end{matrix}\right]\left[\begin{matrix}
            \cos\frac{\delta}{2}&-i\sin\frac{\delta}{2}\\
            -i\sin\frac{\delta}{2}&\cos\frac{\delta}{2}
        \end{matrix}\right]\\
        \notag&=e^{i\alpha}\left[\begin{matrix}
            \cos\frac{\beta}{2}\cos\frac{\gamma}{2}-i\sin\frac{\beta}{2}\sin\frac{\gamma}{2}&-\cos\frac{\beta}{2}\sin\frac{\gamma}{2}-i\sin\frac{\beta}{2}\cos\frac{\gamma}{2}\\
            -i\sin\frac{\beta}{2}\cos\frac{\gamma}{2}+\cos\frac{\beta}{2}\sin\frac{\gamma}{2}&i\sin\frac{\beta}{2}\sin\frac{\gamma}{2}+\cos\frac{\beta}{2}\cos\frac{\gamma}{2}
        \end{matrix}\right]\left[\begin{matrix}
            \cos\frac{\delta}{2}&-i\sin\frac{\delta}{2}\\
            -i\sin\frac{\delta}{2}&\cos\frac{\delta}{2}
        \end{matrix}\right]\\
        \notag&=e^{i\alpha}\\
        \notag&\left[\begin{smallmatrix}
            \left(\cos\frac{\beta}{2}\cos\frac{\gamma}{2}-i\sin\frac{\beta}{2}\sin\frac{\gamma}{2}\right)\cos\frac{\delta}{2}-i\left(-\cos\frac{\beta}{2}\sin\frac{\gamma}{2}-i\sin\frac{\beta}{2}\cos\frac{\gamma}{2}\right)\sin\frac{\delta}{2}&-i\left(\cos\frac{\beta}{2}\cos\frac{\gamma}{2}-i\sin\frac{\beta}{2}\sin\frac{\gamma}{2}\right)\sin\frac{\delta}{2}+\left(-\cos\frac{\beta}{2}\sin\frac{\gamma}{2}-i\sin\frac{\beta}{2}\cos\frac{\gamma}{2}\right)\cos\frac{\delta}{2}\\
            \left(-i\sin\frac{\beta}{2}\cos\frac{\gamma}{2}+\cos\frac{\beta}{2}\sin\frac{\gamma}{2}\right)\cos\frac{\delta}{2}-i\left(i\sin\frac{\beta}{2}\sin\frac{\gamma}{2}+\cos\frac{\beta}{2}\cos\frac{\gamma}{2}\right)\sin\frac{\delta}{2}&-i\left(-i\sin\frac{\beta}{2}\cos\frac{\gamma}{2}+\cos\frac{\beta}{2}\sin\frac{\gamma}{2}\right)\sin\frac{\delta}{2}+\left(i\sin\frac{\beta}{2}\sin\frac{\gamma}{2}+\cos\frac{\beta}{2}\cos\frac{\gamma}{2}\right)\cos\frac{\delta}{2}
        \end{smallmatrix}\right]\\
        \notag&=e^{i\alpha}\\
        \notag&\left[\begin{smallmatrix}
            \cos\frac{\gamma}{2}\left(\cos\frac{\beta}{2}\cos\frac{\delta}{2}-\sin\frac{\beta}{2}\sin\frac{\delta}{2}\right)+i\sin\frac{\gamma}{2}\left(-\sin\frac{\beta}{2}\cos\frac{\delta}{2}+\cos\frac{\beta}{2}\sin\frac{\delta}{2}\right)&\sin\frac{\gamma}{2}\left(-\sin\frac{\beta}{2}\sin\frac{\delta}{2}-\cos\frac{\beta}{2}\cos\frac{\delta}{2}\right)+i\cos\frac{\gamma}{2}\left(-\cos\frac{\beta}{2}\sin\frac{\delta}{2}-\sin\frac{\beta}{2}\cos\frac{\delta}{2}\right)\\
            \sin\frac{\gamma}{2}\left(\cos\frac{\beta}{2}\cos\frac{\delta}{2}+\sin\frac{\beta}{2}\sin\frac{\delta}{2}\right)+i\cos\frac{\gamma}{2}\left(-\sin\frac{\beta}{2}\cos\frac{\delta}{2}-\cos\frac{\beta}{2}\sin\frac{\delta}{2}\right)&\cos\frac{\gamma}{2}\left(-\sin\frac{\beta}{2}\sin\frac{\delta}{2}+\cos\frac{\beta}{2}\cos\frac{\delta}{2}\right)+i\sin\frac{\gamma}{2}\left(-\cos\frac{\beta}{2}\sin\frac{\delta}{2}+\sin\frac{\beta}{2}\cos\frac{\delta}{2}\right)
        \end{smallmatrix}\right]\\
        \notag&=e^{i\alpha}\left[\begin{matrix}
            \cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}-i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}&-\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}-i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}\\
            \sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}-i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}&\cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}+i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}
        \end{matrix}\right]\\
    \end{align}
    Since
    \begin{align}
        \notag&e^{i\alpha}R_z(\beta)R_x(\gamma)R_z(\delta)[e^{i\alpha}R_z(\beta)R_x(\gamma)R_z(\delta)]^{\dagger}\\
        \notag=&e^{i\alpha}\left[\begin{matrix}
            \cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}-i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}&-\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}-i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}\\
            \sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}-i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}&\cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}+i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}
        \end{matrix}\right]\times\\
        \notag&e^{-i\alpha}\left[\begin{matrix}
            \cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}-i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}&-\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}-i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}\\
            \sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}-i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}&\cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}+i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}
        \end{matrix}\right]^{\dagger}\\
        \notag=&\left[\begin{matrix}
            \cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}-i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}&-\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}-i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}\\
            \sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}-i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}&\cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}+i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}
        \end{matrix}\right]\times\\
        \notag&\left[\begin{matrix}
            \cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}+i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}&\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}+i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}\\
            -\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}+i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}&\cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}-i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}
        \end{matrix}\right]\\
        \notag=&\left[\begin{smallmatrix}
            \left(\cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}-i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}\right)\left(\cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}+i\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}\right)+\left(-\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}-i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}\right)\left(-\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}+i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}\right),\\
            \left(\cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}-i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}\right)\left(\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}+i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}\right)+\left(-\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}-i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}\right)\left(\cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}-i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}\right);\\
            \left(\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}-i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}\right)\left(\cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}+i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}\right)+\left(\cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}+i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}\right)\left(-\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}+i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}\right),\\
            \left(\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}-i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}\right)\left(\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}+i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}\right)+\left(\cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}+i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}\right)\left(\cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}-i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}\right)
        \end{smallmatrix}\right]\\
        \notag=&\left[\begin{smallmatrix}
            \cos^2\frac{\gamma}{2}\cos^2\frac{\beta+\delta}{2}+\sin^2\frac{\gamma}{2}\sin^2\frac{\beta-\delta}{2}+\sin^2\frac{\gamma}{2}\cos^2\frac{\beta-\delta}{2}+\cos^2\frac{\gamma}{2}\sin^2\frac{\beta+\delta}{2}&0\\
            0&\sin^2\frac{\gamma}{2}\cos^2\frac{\beta-\delta}{2}+\cos^2\frac{\gamma}{2}\sin^2\frac{\beta+\delta}{2}+\cos^2\frac{\gamma}{2}\cos^2\frac{\beta+\delta}{2}+\sin^2\frac{\gamma}{2}\sin^2\frac{\beta-\delta}{2}
        \end{smallmatrix}\right]\\
        =&\left[\begin{matrix}
            1&0\\
            0&1
        \end{matrix}\right]=I.
    \end{align}
    the $X-Y$ decomposition of rotations is also unitary.
    For arbitrary $a$, $b$, $c$, and $d$ such that $U$ is unitary, let
    \begin{align}
        a=&e^{i\alpha}\left(\cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}-i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}\right),\\
        b=&e^{i\alpha}\left(-\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}-i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}\right),\\
        c=&e^{i\alpha}\left(\sin\frac{\gamma}{2}\cos\frac{\beta-\delta}{2}-i\cos\frac{\gamma}{2}\sin\frac{\beta+\delta}{2}\right),\\
        d=&e^{i\alpha}\left(\cos\frac{\gamma}{2}\cos\frac{\beta+\delta}{2}+i\sin\frac{\gamma}{2}\sin\frac{\beta-\delta}{2}\right),
    \end{align}
    i.e., set
    \begin{align}
        \alpha=&-\frac{i}{2}\ln(ad-bc),\\
        \gamma=&\arccos\frac{a^2-b^2-c^2+b^2}{2(ad-bc)},\\
        \beta=&i\left(\arctan\frac{b+c}{a+d}-\arctan\frac{a-d}{b-c}\right),\\
        \delta=&i\left(\arctan\frac{b+c}{a+d}+\arctan\frac{a-d}{b-c}\right).
    \end{align}
    Then
    \begin{align}
        U=e^{i\alpha}R_z(\beta)R_x(\gamma)R_z(\delta),
    \end{align}
    which is a $X-Y$ decomposition of rotations analogous to Theorem 4.1.
\end{sol}

\begin{exe}
    Suppose $\hat{m}$ and $\hat{n}$ are non-parallel real unit vectors in three dimensions. Use Theorem 4.1 to show that an arbitrary single qubit unitary $U$ may be written
    \begin{align}
        U=e^{i\alpha}R_{\hat{n}}(\beta)R_{\hat{m}}(\gamma)R_{\hat{n}}(\delta),
    \end{align}
    for appropriate choices of $\alpha$, $\beta$, $\gamma$ and $\delta$.
\end{exe}
\begin{pf}
    There is something wrong with this Exercise. Imagine that $\hat{m}$ and $\hat{n}$ are almost parallel but not parallel. In this case, we can not rotate a Bloch vector from paralleling with $\hat{n}$ to anti-paralleling with $\hat{n}$ by first rotating the vector about $\hat{n}$ by some angle $\delta$, then about $\hat{m}$ by some angle $\gamma$, and finally about $\hat{n}$ by some angle $\beta$, with a phase $\alpha$ added. However, this rotation can be represented by unitary operator $U=X$. Therefore, some single qubit unitary $U$ may not be written
    \begin{align}
        U=e^{i\alpha}R_{\hat{n}}(\beta)R_{\hat{m}}(\gamma)R_{\hat{n}}(\delta),
    \end{align}
    with any choices of $\alpha$, $\beta$, $\gamma$ and $\delta$.
\end{pf}

\begin{exe}
    Give $A$, $B$, $C$, and $\alpha$ for the Hadamard gate.
\end{exe}
\begin{sol}
    The Hadamard gate can be written as
    \begin{align}
        H\equiv\frac{1}{\sqrt{2}}\left[\begin{matrix}
            1&1\\
            1&-1
        \end{matrix}\right]=e^{i\alpha}R_z(\beta)R_y(\gamma)R_z(\beta)=\left[\begin{matrix}
            e^{i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2}&-e^{i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2}\\
            e^{i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2}&e^{i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2}
        \end{matrix}\right],
    \end{align}
    i.e.,
    \begin{align}
        e^{i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2}=&\frac{1}{\sqrt{2}},\\
        -e^{i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2}=&\frac{1}{\sqrt{2}},\\
        e^{i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2}=&\frac{1}{\sqrt{2}},\\
        e^{i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2}=&-\frac{1}{\sqrt{2}},
    \end{align}
    so
    \begin{align}
        \alpha=&\frac{\pi}{2},\\
        \beta=&0,\\
        \delta=&\pi,\\
        \gamma=&\frac{\pi}{2}.
    \end{align}
    In this way, for the Hadamard gate,
    \begin{align}
        H=e^{i\alpha}AXBXC,
    \end{align}
    where
    \begin{align}
        \alpha=&\frac{\pi}{2},\\
        A=&R_z(\beta)R_y(\gamma/2)=\left[\begin{matrix}
            e^{-i\beta/2}&0\\
            0&e^{i\beta/2}
        \end{matrix}\right]\left[\begin{matrix}
            \cos\frac{\gamma}{4}&-\sin\frac{\gamma}{4}\\
            \sin\frac{\gamma}{4}&\cos\frac{\gamma}{4}
        \end{matrix}\right]=\left[\begin{matrix}
            e^{-i\beta/2}\cos\frac{\gamma}{4}&-e^{-i\beta/2}\sin\frac{\gamma}{4}\\
            e^{i\beta/2}\sin\frac{\gamma}{4}&e^{i\beta/2}\cos\frac{\gamma}{4}
        \end{matrix}\right]=\left[\begin{matrix}
            \cos\frac{\pi}{8}&-\sin\frac{\pi}{8}\\
            \sin\frac{\pi}{8}&\cos\frac{\pi}{8}
        \end{matrix}\right],\\
        \notag B=&R_y(-\gamma/2)R_z(-(\delta+\beta)/2)=\left[\begin{matrix}
            \cos\left(-\frac{\gamma}{4}\right)&-\sin\left(-\frac{\gamma}{4}\right)\\
            \sin\left(-\frac{\gamma}{4}\right)&\cos\left(-\frac{\gamma}{4}\right)
        \end{matrix}\right]\left[\begin{matrix}
            e^{i(\delta+\beta)/4}&0\\
            0&e^{-i(\delta+\beta)/4}
        \end{matrix}\right]=\left[\begin{matrix}
            e^{i(\delta+\beta)/4}\cos\frac{\gamma}{4}&e^{-i(\delta+\beta)/4}\sin\frac{\gamma}{4}\\
            -e^{i(\delta+\beta)/4}\sin\frac{\gamma}{4}&e^{-i(\delta+\beta)/4}\cos\frac{\gamma}{4}
        \end{matrix}\right]\\
        =&\left[\begin{matrix}
            e^{i\pi/4}\cos\frac{\pi}{8}&e^{-i\pi/4}\sin\frac{\pi}{8}\\
            -e^{i\pi/4}\sin\frac{\pi}{8}&e^{-i\pi/4}\cos\frac{\pi}{8}
        \end{matrix}\right],\\
        C=&R_z((\delta-\beta)/2)=\left[\begin{matrix}
            e^{-i(\delta-\beta)/4}&0\\
            0&e^{i(\delta-\beta)/4}
        \end{matrix}\right]=\left[\begin{matrix}
            e^{-i\pi/4}&0\\
            0&e^{i\pi/4}
        \end{matrix}\right]
    \end{align}
\end{sol}

\begin{exe}[Circuit identities]
    It is useful to be able to simplify circuit by inspection, using well-known identities. Prove the following three identities:
    \begin{align}
        HXH=Z;\quad HYH=-Y,\quad HZH=X.
    \end{align}
\end{exe}
\begin{pf}
    \begin{align}
        HXH=&\frac{1}{\sqrt{2}}\left[\begin{matrix}
            1&1\\
            1&-1
        \end{matrix}\right]\left[\begin{matrix}
            0&1\\
            1&0
        \end{matrix}\right]\frac{1}{\sqrt{2}}\left[\begin{matrix}
            1&1\\
            1&-1
        \end{matrix}\right]=\left[\begin{matrix}
            1&0\\
            0&-1
        \end{matrix}\right]=Z,\\
        HYH=&\frac{1}{\sqrt{2}}\left[\begin{matrix}
            1&1\\
            1&-1
        \end{matrix}\right]\left[\begin{matrix}
            0&-i\\
            i&0
        \end{matrix}\right]\frac{1}{\sqrt{2}}\left[\begin{matrix}
            1&1\\
            1&-1
        \end{matrix}\right]=\left[\begin{matrix}
            0&i\\
            -i&0
        \end{matrix}\right]=-Y,\\
        HZH=&\frac{1}{\sqrt{2}}\left[\begin{matrix}
            1&1\\
            1&-1
        \end{matrix}\right]\left[\begin{matrix}
            1&0\\
            0&-1
        \end{matrix}\right]\frac{1}{\sqrt{2}}\left[\begin{matrix}
            1&1\\
            1&-1
        \end{matrix}\right]=\left[\begin{matrix}
            0&1\\
            1&0
        \end{matrix}\right]=X.
    \end{align}
\end{pf}

\begin{exe}
    Use the previous exercise to show that $HTH=R_x(\pi/4)$, up to a global phase.
\end{exe}
\begin{pf}
    Since
    \begin{align}
        HTH=H\left(\cos\frac{\pi}{8}I-i\sin\frac{\pi}{8}Z\right)H=\cos\frac{\pi}{8}I-i\sin\frac{\pi}{8}X=R_x(\pi/4).
    \end{align}
\end{pf}

\begin{exe}[Composition of single qubit operations]
    The Bloch representation gives a nice way to visualize the effect of composing two rotations.
    \begin{itemize}
        \item[(1)] Prove that if a rotation through an angle $\beta_1$ about the axis $\hat{n}_1$ is followed by a rotation through an angle $\beta_2$ about an axis $\hat{n}_2$, then the overall rotation is through an angle $\beta_{12}$ about an axis $\hat{n}_{12}$ given by
        \begin{align}
            c_{12}=&c_1c_2-s_1s_2\hat{n}_1\cdot\hat{n}_2\\
            s_{12}\hat{n}_{12}=&s_1c_2\hat{n}_1+c_1s_2\hat{n}_2-s_1s_2\hat{n}_2\times\hat{n}_1,
        \end{align}
        where $c_i=\cos(\beta_i/2)$, $s_i=\sin(\beta_i/2)$, $c_{12}=\cos(\beta_{12}/2)$, and $s_{12}=\sin(\beta_{12}/2)$.
        \item[(2)] Show that if $\beta_1=\beta_2$ and $\hat{n}_1=\hat{z}$ these equations simplify to
        \begin{align}
            c_{12}=&c^2-s^2\hat{z}\cdot\hat{n}_2\\
            s_{12}\hat{n}_{12}=&sc(\hat{z}+\hat{n})-s^2\hat{n}_2\times\hat{z},
        \end{align}
        where $c=c_1$ and $s=s_1$.
    \end{itemize}
\end{exe}
\begin{pf}
    \begin{itemize}
        \item[(1)] A rotation through an angle $\beta_1$ about the axis $\hat{n}_1$ followed by a rotation through an angle $\beta_2$ about an axis $\hat{n}_2$ is given by
        \begin{align}
            \notag R_{\hat{n}_2}(\beta_2)R_{\hat{n}_1}(\beta_1)=&\left[c_2I-is_2(n_{2x}X+n_{2y}Y+n_{2z}Z)\right]\left[c_1I-is_1(n_{1x}X+n_{1y}Y+n_{1z}Z)\right]\\
            \notag=&c_2c_1I-ic_2s_1(n_{1x}X+n_{1y}Y+n_{1z}Z)-is_2c_1(n_{2x}X+n_{2y}Y+n_{2z}Z)\\
            \notag&-s_2s_1(n_{2x}X+n_{2y}Y+n_{2z}Z)(n_{1x}X+n_{1y}Y+n_{1z}Z)\\
            \notag=&c_2c_1I-ic_2s_1(n_{1x}X+n_{1y}Y+n_{1z}Z)-is_2c_1(n_{2x}X+n_{2y}Y+n_{2z}Z)\\
            \notag&-s_2s_1(n_{2x}n_{1x}XX+n_{2x}n_{1y}XY+n_{2x}n_{1z}XZ+n_{2y}n_{1x}YX+n_{2y}n_{1y}YY+n_{2y}n_{1z}YZ\\
            \notag&+n_{2z}n_{1x}ZX+n_{2z}n_{1y}ZY+n_{2z}n_{1z}ZZ)\\
            \notag=&c_2c_1I-ic_2s_1(n_{1x}X+n_{1y}Y+n_{1z}Z)-is_2c_1(n_{2x}X+n_{2y}Y+n_{2z}Z)\\
            \notag&-s_2s_1(n_{2x}n_{1x}I+in_{2x}n_{1y}Z-in_{2x}n_{1z}Y-in_{2y}n_{1x}Z+n_{2y}n_{1y}I+in_{2y}n_{1z}X\\
            \notag&+in_{2z}n_{1x}Y-in_{2z}n_{1y}X+n_{2z}n_{1z}I)\\
            \notag=&[c_2c_1-s_2s_1(n_{1x}n_{2x}+n_{2y}n_{1y}+n_{2z}n_{1z})]I-i[c_2s_1n_{1x}+s_2c_1n_{2x}+s_2s_1(n_{2y}n_{1z}-n_{2z}n_{1y})]X\\
            \notag&-i[c_2s_1n_{1y}+s_2c_1n_{2y}+s_2s_1(-n_{2x}n_{1z}+n_{2z}n_{1x})]Y\\
            &-i[c_2s_1n_{1z}+s_2c_1n_{2z}+s_2s_1(n_{2x}n_{1y}-n_{2y}n_1x)]Z.
        \end{align}
        The rotation through an angle $\beta_{12}$ about an axis $\hat{n}_{12}$ where
        \begin{align}
            c_{12}=&c_1c_2-s_1s_2\hat{n}_1\hat{n}_2,\\
            s_{12}\hat{n}_{12}=&s_1c_2\hat{n}_1+c_1s_2\hat{n}_2-s_1s_2\hat{n}_2\times\hat{n}_1,
        \end{align}
        i.e.,
        \begin{align}
            c_{12}=&c_1c_2-s_1s_2(n_{1x}n_{2x}+n_{1y}n_{2y}+n_{1z}n_{2z}),\\
            s_{12}n_{12x}=&s_1c_2n_{1x}+c_1s_2n_{2x}-s_1s_2(n_{2y}n_{1z}-n_{2z}n_{1y}),\\
            s_{12}n_{12y}=&s_1c_2n_{1y}+c_1s_2n_{2y}-s_1s_2(n_{2z}n_{1x}-n_{2x}n_{1z}),\\
            s_{12}n_{12z}=&s_1c_2n_{1z}+c_1s_2n_{2z}-s_1s_2(n_{2x}n_{1y}-n_{2y}n_{1x}),
        \end{align}
        is given by
        \begin{align}
            \notag R_{\hat{n}_{12}}(\beta_{12})=&c_{12}I-is_{12}(n_{12x}X+n_{12y}Y+n_{12z}Z)\\
            \notag=&[c_1c_2-s_1s_2(n_{1x}n_{2x}+n_{1y}n_{2y}+n_{1z}n_{2z})]I-i[s_1c_2n_{1x}+c_1s_2n_{2x}-s_1s_2(n_{2y}n_{1z}-n_{2z}n_{1y})]X\\
            &-i[s_1c_2n_{1y}+c_1s_2n_{2y}-s_1s_2(n_{2z}n_{1x}-n_{2x}n_{1z})]Y-i[s_1c_2n_{1z}+c_1s_2n_{2z}-s_1s_2(n_{2x}n_{1y}-n_{2y}n_{1x})]Z.
        \end{align}
        Therefore, if a rotation through an angle $\beta_1$ about the axis $\hat{n}_1$ is followed by a rotation through an angle $\beta_2$ about an axis $\hat{n}_2$, then the overall rotation is through an angle $\beta_{12}$ about an axis $\hat{n}_{12}$.
        \item[(b)] If $\beta_1=\beta_2$ and $\hat{n}_1=\hat{z}$, then $c=c_1=c_2$, $s=s_1=s_2$, $n_{1x}=n_{1y}=0$, $n_{1z}=1$, and these equations simplify to
        \begin{align}
            c_{12}=&c_1c_2-s_1s_2\hat{n}_1\hat{n}_2=c^2-s^2\hat{z}\cdot\hat{n}_2,\\
            s_{12}\hat{n}_{12}=&s_1c_2\hat{n}_1+c_1s_2\hat{n}_2-s_1s_2\hat{n}_2\times\hat{n}_1=sc(\hat{z}+\hat{n})-s^2\hat{n}_2\times\hat{z}.
        \end{align}
    \end{itemize}
\end{pf}

\section{Controlled operations}

\begin{exe}[Matrix representation of multi-qubit gates]
    What is the $4\times 4$ unitary matrix for the circuit
    \begin{center}
        \begin{quantikz}
            \lstick{$x_2$} & \gate{H} & \qw \\
            \lstick{$x_1$} & \qw & \qw
        \end{quantikz}
    \end{center}
        in the computational basis? What is the unitary matrix for the circuit
    \begin{center}
        \begin{quantikz}
            \lstick{$x_2$} & \qw & \qw\\
            \lstick{$x_1$} & \gate{H} & \qw
        \end{quantikz}
    \end{center}
    in the computational basis?
\end{exe}
\begin{sol}
    For the first quantum circuit, the $4\times 4$ unitary is
    \begin{align}
        I\otimes H=\left[\begin{matrix}
            1&0\\
            0&1
        \end{matrix}\right]\otimes\frac{1}{\sqrt{2}}\left[\begin{matrix}
            1&1\\
            1&-1
        \end{matrix}\right]=\frac{1}{\sqrt{2}}\left[\begin{matrix}
            1&1&0&0\\
            1&-1&0&0\\
            0&0&1&1\\
            0&0&1&-1
        \end{matrix}\right].
    \end{align}
    The unitary matrix for the second quantum circuit is
    \begin{align}
        H\otimes I=\frac{1}{\sqrt{2}}\left[\begin{matrix}
            1&1\\
            1&-1
        \end{matrix}\right]\otimes\left[\begin{matrix}
            1&0\\
            0&1
        \end{matrix}\right]=\frac{1}{\sqrt{2}}\left[\begin{matrix}
            1&0&1&0\\
            0&1&0&1\\
            1&0&-1&0\\
            0&1&0&-1
        \end{matrix}\right].
    \end{align}
\end{sol}

\begin{exe}[Building CNOT from from controlled-$Z$ gates]
    Construct a CNOT gate from one controlled-$Z$ gate, that is, the gate whose action in the computational basis is specified by the unitary matrix
    \[
        \left[\begin{matrix}
            1&0&0&0\\
            0&1&0&0\\
            0&0&1&0\\
            0&0&0&-1
        \end{matrix}\right],
    \]
    and two Hadamard gates, specifying the control and target qubits.
\end{exe}
\begin{sol}
    Since
    \begin{align}
        (I\otimes H)\left[\begin{matrix}
            1&0&0&0\\
            0&1&0&0\\
            0&0&1&0\\
            0&0&0&-1
        \end{matrix}\right](I\otimes H)=\frac{1}{\sqrt{2}}\left[\begin{matrix}
            1&1&0&0\\
            1&-1&0&0\\
            0&0&1&1\\
            0&0&1&-1
        \end{matrix}\right]\left[\begin{matrix}
            1&0&0&0\\
            0&1&0&0\\
            0&0&1&0\\
            0&0&0&-1
        \end{matrix}\right]\frac{1}{\sqrt{2}}\left[\begin{matrix}
            1&1&0&0\\
            1&-1&0&0\\
            0&0&1&1\\
            0&0&1&-1
        \end{matrix}\right]=\left[\begin{matrix}
            1&0&0&0\\
            0&1&0&0\\
            0&0&0&1\\
            0&0&1&0
        \end{matrix}\right],
    \end{align}
    \begin{center}
        \begin{quantikz}
            \qw & \ctrl{1} & \qw\\
            \qw & \targ{} & \qw
        \end{quantikz}
        $=$
        \begin{quantikz}
            \qw & \qw & \ctrl{1} & \qw & \qw\\
            \qw & \gate{H} & \gate{Z} & \gate{H} & \qw
        \end{quantikz}
    \end{center}
\end{sol}

\begin{exe}
    Show that
    \begin{center}
        \begin{quantikz}
            \qw & \ctrl{1} & \qw\\
            \qw & \gate{Z} & \qw
        \end{quantikz}
        $=$
        \begin{quantikz}
            \qw & \gate{Z} & \qw\\
            \qw & \ctrl{-1} & \qw
        \end{quantikz}
    \end{center}
\end{exe}
\begin{pf}
    Since the unitary matrices of the two quantum circuits are both
    \begin{align}
        \left[\begin{matrix}
            1&0&0&0\\
            0&1&0&0\\
            0&0&1&0\\
            0&0&0&-1
        \end{matrix}\right],
    \end{align}
    these two quantum circuits equal.
\end{pf}

\begin{exe}[CNOT action on density matrices]
    The CNOT gate is a simple permutation whose action on density matrix $\rho$ is to rearrange the elements in the matrix. Write out this action explicitly in the computational basis.
\end{exe}
\begin{sol}
    The CNOT gate exchanges the coefficients of $\lvert 10\rangle\langle 10\rvert$ component and $\lvert 11\rangle\langle 11\rvert$ component, $\lvert 10\rangle\langle 11\rvert$ component and $\lvert 11\rangle\langle 10\rvert$ component.
\end{sol}

\begin{exe}[CNOT basis transformations]
    Unlike ideal classical gates, ideal quantum gates do not have (as electrical engineers say) `high-impedance' inputs. In fact, the role of role of `control' and `target' are arbitrary -- they depend on what basis you think of a device as operating in. We have described how the CNOT behaves with respect to the computational basis, and in this description the state of the control qubit is not changed. However, if we work in a different basis then the control qubit \emph{does} change: we will show that its phase is flipped depending on the state of the `target' qubits! Show that
    \begin{center}
        \begin{quantikz}
            \qw & \gate{H} & \ctrl{1} & \gate{H} & \qw\\
            \qw & \gate{H} & \targ{} & \gate{H} & \qw
        \end{quantikz}
        $=$
        \begin{quantikz}
            \qw & \targ{} & \qw\\
            \qw & \ctrl{-1} & \qw
        \end{quantikz}
    \end{center}
    Introducing basis states $\lvert\pm\rangle=(\lvert 0\rangle\pm\lvert 1\rangle)/\sqrt{2}$, use this circuit identity to show that the effect of a CNOT with the first qubit as control and the second qubit as target is as follows:
    \begin{align}
        \lvert+\rangle\lvert+\rangle\rightarrow&\lvert+\rangle\lvert+\rangle\\
        \lvert-\rangle\lvert+\rangle\rightarrow&\lvert-\rangle\lvert+\rangle\\
        \lvert+\rangle\lvert-\rangle\rightarrow&\lvert-\rangle\lvert-\rangle\\
        \lvert-\rangle\lvert-\rangle\rightarrow&\lvert+\rangle\lvert-\rangle,
    \end{align}
    Thus, with respect to this new basis, the state of the target qubit is not changed, while the state of the control qubit is flipped if the target starts as $\lvert-\rangle$, otherwise it is left alone. That is, in this basis, targe and control have essentially interchanged roles!
\end{exe}
\begin{pf}
    
\end{pf}

\ifx\allfiles\undefined
\end{document}
\fi